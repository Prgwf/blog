---
title: TwoSAT小结
date: 2017-08-29 20:02:52
mathjax: true
categories:
  - algorithm
tags:
  - 连通性
  - 2-SAT
---
挑战上是这样定义的：
给定一个布尔方程，判断是否存在一组布尔变量的真值指派使整个方程为真的问题，称之为布尔方程的可满足性问题(SAT)。
$$
(a \vee b \vee ...) \wedge (c \vee d \vee ...) \wedge ...
$$
如果所有()中最多两个布尔变量，那就是一个``2-SAT``问题。

用刘大爷的话说就是：有$n$个布尔变量$x_i$,另有$m$个需要满足的条件，每个条件的形式都是”$x_i$为真(假)或$x_j$为真(假)”。

我看了刘大爷的例题上的建图方法，我猜测``add_clause(x, xval ^ 1, y, yval ^ 1)``这个表示$x$取$xval$这个值和$y$取$yval$这个值冲突，所以我加边的时候都是加冲突的情况。做了几个题下来这样建图到也问题不大。

### POJ3207
一个圆周上顺序的标了$N$个点，给出$M$个条件，每个条件是使两个点在圆内或圆外连线，求是否出现线相交的情况。

首先把条件给的两个点换成一条线。
$0$表示在圆内连线
$1$表示在圆外连线
当一条边的一个端点在另一条的两个端点之间，另一个端点在外边的时候，是相交的。
对于可能会相交的两条线$p, q$，加边。
``
add_clause(p, 0 ^ 1, q, 0 ^ 1); add_clause(p, 1 ^ 1, q, 1 ^ 1);
``
表示它们同时在圆内或者圆外连线是冲突的。

[代码](https://github.com/Prgwf/solve/blob/master/POJ/POJ3207.cpp)

### POJ3683
有$N$对新人结婚，每对有两个时间段,$S_i \sim S_i+D_i$和$T_i-D_i \sim Ti$。求所有时间能否不重叠。

$0$表示第$i$对在$S_i \sim S_i+D_i$这个时间结婚
$1$表示第$i$对在$T_i-D_i \sim T_i$这个时间结婚
```cpp
bool hit(int xstart, int xend, int ystart, int yend) {
  if (xend <= ystart || yend <= xstart) return false;
  return true;
}
```
两两判断一下，一共四种情况，有冲突就加边。

[代码](https://github.com/Prgwf/solve/blob/master/POJ/POJ3683.cpp)

### POJ3678
给一些点对和$and, or, xor$中某个运算，告诉你他们之间的结果$0$或$1$。求是否冲突。

and:x, y都为真时值才为真
- ``x and y = 1``:
  ```
  add_clause(x, 1 ^ 1, y, 0 ^ 1);
  add_clause(x, 0 ^ 1, y, 1 ^ 1);
  add_clause(x, 0 ^ 1, y, 0 ^ 1);
  ```
- ``x and y = 0``:
  ```
  add_clause(x, 1 ^ 1, y, 1 ^ 1);
  ```
or:x, y都为假时值才为假
- ``x or y = 1``:
  ```
  add_clause(x, 0 ^ 1, y, 0 ^ 1);
  ```
  ``x or y = 0``:
  ```
  add_clause(x, 1 ^ 1, y, 0 ^ 1);
  add_clause(x, 0 ^ 1, y, 1 ^ 1);
  add_clause(x, 1 ^ 1, y, 1 ^ 1);
  ```
xor:x, y不同时值为真，相同时值为假
- ``x xor y = 1``:
  ```
  add_clause(x, 1 ^ 1, y, 1 ^ 1);
  add_clause(x, 0 ^ 1, y, 0 ^ 1);
  ```
- ``x xor y = 0``:
  ```
  add_clause(x, 1 ^ 1, y, 0 ^ 1);
  add_clause(x, 0 ^ 1, y, 1 ^ 1);
  ```
[代码](https://github.com/Prgwf/solve/blob/master/POJ/POJ3678.cpp)

### POJ3648
这个剧情比复杂。简单来说就是一对新人结婚，请了一些夫妻。有一个很长的板凳，成对的男女不能坐在同侧，给出一些淫乱的关系，他们不能同时坐在新娘子对面，求有没有这样一种坐法。

$0$表示$i$这对夫妻中的丈夫坐新娘子对面
$1$表示$i$这对夫妻中的妻子坐新娘子对面
按上面定义的01的意义已经保证了不会出现成对的男女出现在板凳同侧的情况了。那么只要处理淫乱的情况就行了。比如x的husband和y的husband是淫乱关系，那么他们不能同时坐在新娘子对面。那么就按之前赋予的意义加边``add_clause(x, 0 ^ 1, y, 0 ^ 1);``
最后还要加一条``add_clause(0, 1 ^ 1, 0, 1 ^ 1);``为了让新娘和新郎不在同侧，挺迷的。

[代码](https://github.com/Prgwf/solve/blob/master/POJ/POJ3648.cpp)

### POJ2723
剧情也挺长的：$2N$把钥匙，有$M$层的一个类似迷宫的玩意，每层有一个门，门上有两个锁只要随意打开一个就可以通过到上一层，但是$2N$把锁是分成了$N$对，也就是选了一对中的某一把，另一把就彻底消失了，被选的那把可以一直用，问最多可以去到几层。

$0$表示不用i这把锁
$1$表示用i这把锁
一开始的$N$对都加边``add_clause(x, 1 ^ 1, y, 1 ^ 1);``表示其中两把都用是冲突的。
由于数据小而且是一层一层上去的，所以我就没有用二分去搞，直接就每有一个冲突的条件我就加一次边``add_clause(x, 0 ^ 1, y, 0 ^ 1);``表示两个锁都不开是冲突的，然后跑一次DFS标记一旦false了就结束。

[代码](https://github.com/Prgwf/solve/blob/master/POJ/POJ2723.cpp)

### POJ2749
这个剧情也是很烦：给两个中转站的坐标，再给一些点的坐标，这些点要和其中一个中转站相连，但这些点中有些点不能连在同一个中转站，有些点必须连在同一个中转站，让你最小化任意两个农场通过中转站的最大距离，这个题的距离是曼哈顿距离。

$0$表示连$0$这个中转站
$1$表示连$1$这个中转站
直接二分答案，判断是否冲突加边，一种冲突是距离大于了当前二分出的值，另一种就是题意给出的。

[代码](https://github.com/Prgwf/solve/blob/master/POJ/POJ2749.cpp)


### 小结
这个坑也是拖了太久，刚开始的时候不是很懂刘大爷的模板怎么用，网上很多题解也是各种各样的方法，``tarjan``的，两遍``DFS``的都有，但是做了几个题之后发现这个``2-SAT``还是挺套路的一个东西，主要是看出题目是一个``2-SAT``，然后给0,1布尔值赋一个意义，然后用冲突建个图，最后跑一下模板就好了。
嗨呀，就是这么愉快的水了发博客，但是最近好懒，都不怎么想写。
